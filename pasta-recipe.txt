Option Explicit

Sub Przycisk4_KlikniÄ™cie()
    Dim wrk As Workbook
    Dim Sh As Worksheet
    Dim SourceFolder As String, Path As String, TmpFlName As String
    Dim i As Long, lastrow As Long
    
    SourceFolder = ThisWorkbook.Path & "\source"
    
    If Dir(SourceFolder & "\PIDs_with_ADDorETA.*") <> "" Then
        If InStr(1, Dir(SourceFolder & "\PIDs_with_ADDorETA.*"), ".csv") Then
                        TmpFlName = SourceFolder & "\TmpCsv.txt"
                        If Dir(TmpFlName) <> "" Then Kill TmpFlName
                        FileCopy SourceFolder & "\PIDs_with_ADDorETA.csv", TmpFlName
                        Workbooks.OpenText Filename:=TmpFlName, origin:= _
                        1250, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
                        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=False _
                        , Space:=False, Other:=False, TrailingMinusNumbers:=True, Local:=False
                    
                        Set wrk = Application.Workbooks("TmpCsv.txt")
                        Set Sh = wrk.Worksheets(1)
            'Set wrk = Application.Workbooks.Open(SourceFolder & "\PIDs_with_ADDorETA.xlsx")
            'Set Sh = wrk.Worksheets(1)
            
            lastrow = Sh.Cells(Sh.Rows.Count, "A").End(xlUp).row
            
            For i = 2 To lastrow
                If Len(Sh.Cells(i, 5)) > 10 Then
                    Sh.Cells(i, 5) = Left(Sh.Cells(i, 5).Value, 10)
                    'Sh.Cells(i, 5).Interior.ColorIndex = 6
                End If
            Next i
            
            Else
            
            MsgBox "no ""PIDs_with_ADDorETA"" file in the source folder"
            Exit Sub
        End If
    End If
    
    If InStr(1, wrk.Name, "TmpCsv.txt") Then
        wrk.SaveAs Filename:=Dir(SourceFolder & "\PIDs_with_ADDorETA.*"), FileFormat:=xlCSV, Local:=True
        wrk.Close False
        Kill TmpFlName
    End If
End Sub

