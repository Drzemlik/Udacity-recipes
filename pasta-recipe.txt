Option Explicit


Sub PERFtoWMA()

Dim WMAtable, PERFdest, HPEsummary As Worksheet
Dim PERFdestTables, HPEtable, WMAcell, PERFcell, WMAcell_0 As Range
Dim i, j, endi As Integer


Set WMAtable = Workbooks(Dir("path_week_*.xlsx")).Worksheets("performance")
Set PERFdest = Workbooks(Dir("path_Performance_report*.xlsb")).Worksheets("Destination country")
Set HPEsummary = Workbooks(Dir("path_Performance_report*.xlsb")).Worksheets("HPE_summary")
Set PERFdestTables = PERFdest.Range("A1:AS19")


endi = WMAtable.Range("C16", WMAtable.Range("C16").End(xlDown)).Rows.Count - 1
   
   For i = 1 To endi
   
    Set WMAcell = WMAtable.Range("C16:c40").Cells(i)
    Set PERFcell = PERFdestTables.Find(What:=WMAcell, LookIn:=xlValues, MatchCase:=True)
    Set HPEtable = HPEsummary.Cells(21, 3)


        If Not PERFcell Is Nothing Then
        
            PERFcell.Offset(-15).Copy
            WMAcell(j).Offset(1, 1).PasteSpecial (xlPasteValues)
            PERFcell.Offset(-4).Copy
            WMAcell(j).Offset(1, 2).PasteSpecial (xlPasteValues)
            PERFcell.Offset(-3).Copy
            WMAcell(j).Offset(1, 3).PasteSpecial (xlPasteValues)
            PERFcell.Offset(-8).Copy
            WMAcell(j).Offset(1, 5).PasteSpecial (xlPasteValues)
            PERFcell.Offset(-10).Copy
            WMAcell(j).Offset(1, 7).PasteSpecial (xlPasteValues)
            PERFcell.Offset(-9).Copy
            WMAcell(j).Offset(1, 8).PasteSpecial (xlPasteValues)
                       
        End If
    
    Next i
    
WMAtable.Range("E16:K40").Replace What:="something went wrong", Replacement:="-"
WMAtable.Range("E16:K40").Replace What:="something went worng", Replacement:="-"

    
    With HPEtable
    
        .Offset(-15).Copy
        WMAtable.Cells(31, 4).PasteSpecial (xlPasteValues)
        .Offset(-4).Copy
        WMAtable.Cells(31, 5).PasteSpecial (xlPasteValues)
        .Offset(-3).Copy
        WMAtable.Cells(31, 6).PasteSpecial (xlPasteValues)
        .Offset(-8).Copy
        WMAtable.Cells(31, 8).PasteSpecial (xlPasteValues)
        .Offset(-10).Copy
        WMAtable.Cells(31, 10).PasteSpecial (xlPasteValues)
        .Offset(-9).Copy
        WMAtable.Cells(31, 11).PasteSpecial (xlPasteValues)
            
    End With

End Sub

